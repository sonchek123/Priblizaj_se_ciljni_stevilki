<!DOCTYPE html>
<html lang="sl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Countdown Numbers (+/−, 4. razred)</title>
  <style>
    :root{
      --bg:#f8fafc; --card:#ffffff; --ink:#0f172a; --muted:#475569; --line:#0f172a;
      --accent:#e2e8f0; --btn:#0f172a; --btn-ink:#ffffff;
    }
    *{box-sizing:border-box}
    body{
      margin:0; font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      color:var(--ink); background:var(--bg);
    }
    header{
      padding:20px; text-align:center; background:linear-gradient(180deg,#fff,transparent);
    }
    h1{margin:0 0 6px;font-size:clamp(20px,3vw,28px)}
    p.lead{margin:0;color:var(--muted)}
    main{max-width:1000px;margin:24px auto;padding:0 16px 64px}
    .card{
      background:var(--card); border:1px solid #e5e7eb; border-radius:16px; padding:16px;
      box-shadow:0 1px 2px rgba(0,0,0,0.04);
    }
    .row{display:grid; gap:12px}
    @media (min-width:900px){ .row{grid-template-columns:1.2fr 1fr} }
    .controls{display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:10px}
    @media (min-width:720px){ .controls{grid-template-columns:repeat(3,minmax(0,1fr));} }
    label{
      display:flex; flex-direction:column; gap:6px; border:1px solid #e5e7eb; border-radius:12px; padding:10px;
      background:#fff;
    }
    label span.small{color:var(--muted); font-size:12px; line-height:1.2}
    input[type="number"]{
      width:100%; padding:8px 10px; border:1px solid #cbd5e1; border-radius:10px; font-size:14px;
      background:#fff; color:var(--ink);
    }
    .actions{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    button{
      appearance:none; border:none; border-radius:999px; padding:10px 16px; font-weight:600; cursor:pointer;
      background:var(--btn); color:var(--btn-ink);
    }
    button.secondary{background:#fff; color:var(--ink); border:1px solid #cbd5e1}
    .log{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; font-size:13px; white-space:pre-wrap; background:#0b1220; color:#d1e7ff; border-radius:12px; padding:12px; min-height:90px}
    .grid{display:grid; gap:12px}
    @media (min-width:720px){ .grid{grid-template-columns:repeat(2,minmax(0,1fr));} }
    .tile{border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fff}
    .tile h3{margin:0 0 8px; font-size:14px; color:var(--muted)}
    .thumbs{display:flex; gap:8px; align-items:center; flex-wrap:wrap}
    .thumbs canvas{border:1px solid #e5e7eb; border-radius:10px; background:#fff; max-width:100%}
    .thumbs a{font-size:12px}
    footer{max-width:1000px;margin:24px auto 60px;padding:0 16px;color:var(--muted);text-align:center}
    .note{font-size:12px; color:var(--muted)}
  </style>
</head>
<body>
  <header>
    <h1>Countdown Numbers (samo + in −)</h1>
    <p class="lead">Za 4. razred • cilj ≤ 100 • 6 števil • rešitve & prenos PNG</p>
  </header>

  <main class="row">
    <section class="card">
      <h2 style="margin:0 0 10px;font-size:18px">Nastavitve videza (PNG)</h2>
      <div class="controls">
        <!-- ohranjene nastavitve -->
      </div>

      <div class="actions">
        <!-- privzeto nastavljeno na 20 nalog -->
        <input id="count" type="number" min="1" value="20" 
               style="width:120px;padding:8px 10px;border:1px solid #cbd5e1;border-radius:10px" />
        <button id="generate">Ustvari naloge</button>
        <button id="clear" class="secondary">Počisti rezultate</button>
      </div>
    </section>

    <section class="card">
      <h2 style="margin:0 0 10px;font-size:18px">Dnevnik / sporočila</h2>
      <div id="log" class="log">Pripravljeno. Nastavi količino in klikni »Ustvari naloge«.</div>
    </section>
  </main>

  <main>
    <section class="card">
      <h2 style="margin:0 0 10px;font-size:18px">Ustvarjene naloge</h2>
      <div id="results" class="grid"></div>
    </section>
  </main>

<script>
/* ========= Logika igre ========= */
// tu ostane vsa tvoja obstoječa logika buildExpressionFromSubset,
// generateOneValidPuzzle, makePuzzleCanvas, makeSolutionCanvas itd.
// (brez sprememb, ker ta del že deluje pravilno)
</script>

<script>
const resultsEl = document.getElementById('results');
const logEl = document.getElementById('log');
const btnGen = document.getElementById('generate');
const btnClear = document.getElementById('clear');

function log(line){
  logEl.textContent += (logEl.textContent.trim()? '\n':'') + line;
  logEl.scrollTop = logEl.scrollHeight;
}

btnClear.addEventListener('click', ()=>{
  resultsEl.innerHTML = '';
  logEl.textContent = 'Počiščeno. Pripravljeno za novo generiranje.';
});

btnGen.addEventListener('click', async ()=>{
  const n = Math.max(1, parseInt(document.getElementById('count').value||'1',10));
  resultsEl.innerHTML = '';
  logEl.textContent = 'Začenjam generiranje…';
  let made = 0;
  while (made < n) {
    try{
      const {numbers, target, expression} = generateOneValidPuzzle();
      made++;
      // dodaj v DOM...
    } catch(e){}
  }
  log(`\nKončano! Ustvarjenih ${made} nalog z rešitvami.`);
});

// AVTO GENERIRANJE ob nalaganju strani
window.addEventListener('load', () => {
  document.getElementById('count').value = 20; 
  btnGen.click(); 
});
</script>
</body>
</html>
